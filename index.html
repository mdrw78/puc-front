<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ABC Auto Advisor - Document Management</title>
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f8f9fa; }
        
        /* Sidebar Styling */
        .sidebar {
            width: 260px;
            background-color: #111827; /* slate-900 */
            color: white;
            height: 100vh;
            position: fixed;
            top: 0;
            left: 0;
            z-index: 1000;
            display: flex;
            flex-direction: column;
        }
        
        .sidebar-header {
            height: 64px;
            display: flex;
            align-items: center;
            padding: 0 24px;
            border-bottom: 1px solid #374151;
        }

        .nav-link {
            color: #d1d5db; /* slate-300 */
            padding: 10px 24px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            text-decoration: none;
            transition: all 0.2s;
        }

        .nav-link:hover {
            background-color: #1f2937; /* slate-800 */
            color: white;
        }

        .nav-link.active {
            background-color: #2563eb; /* blue-600 */
            color: white;
            border-right: 4px solid #60a5fa; /* blue-400 */
        }

        .nav-section-title {
            padding: 0 24px;
            margin-top: 24px;
            margin-bottom: 8px;
            font-size: 0.75rem;
            font-weight: 600;
            color: #6b7280; /* slate-500 */
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .badge-custom {
            background-color: #374151; /* slate-700 */
            font-size: 0.75rem;
            padding: 2px 8px;
            border-radius: 9999px;
        }

        /* Main Content Area */
        .main-content {
            margin-left: 260px;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .top-header {
            height: 64px;
            background-color: white;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 32px;
            flex-shrink: 0;
        }

        .content-scrollable {
            flex: 1;
            overflow-y: auto;
            padding: 24px;
        }

        /* Excel-like Table Styling */
        .table-container {
            overflow-x: auto;
            position: relative;
        }

        .excel-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.875rem;
        }

        .excel-table th {
            background-color: #f3f4f6;
            color: #374151;
            font-weight: 600;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            border: 1px solid #e5e7eb;
            padding: 8px 12px;
            white-space: nowrap;
        }

        .excel-table td {
            border: 1px solid #e5e7eb;
            padding: 6px 12px;
            white-space: nowrap;
            position: relative;
        }
        
        .excel-table td:hover {
            border: 1px solid #3b82f6;
            cursor: cell;
        }

        .excel-table td input {
            width: 100%;
            height: 100%;
            border: none;
            outline: none;
            background: transparent;
            font-size: inherit;
            padding: 0;
            margin: 0;
        }

        /* Status Colors */
        .row-expired { background-color: #fee2e2 !important; } /* Red-100 */
        .row-expiring-soon { background-color: #fef9c3 !important; } /* Yellow-100 */
        .cell-na { color: #9ca3af; font-style: italic; }
        
        /* Sticky Columns */
        .sticky-col-left {
            position: sticky;
            left: 0;
            background-color: inherit;
            z-index: 10;
        }
        .sticky-col-left-2 {
            position: sticky;
            left: 35px;
            background-color: inherit;
            z-index: 10;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1; 
        }
        ::-webkit-scrollbar-thumb {
            background: #c1c1c1; 
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8; 
        }

        /* Card Hover Effects */
        .summary-card {
            transition: all 0.2s;
        }
        .summary-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }

        /* Responsive Styles */
        @media (max-width: 991.98px) {
            .sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s ease-in-out;
            }
            .sidebar.show {
                transform: translateX(0);
            }
            .main-content {
                margin-left: 0;
            }
            .sidebar-overlay {
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background-color: rgba(0, 0, 0, 0.5);
                z-index: 999;
                opacity: 0;
                transition: opacity 0.3s ease-in-out;
            }
            .sidebar-overlay.show {
                display: block;
                opacity: 1;
            }
        }
    </style>
</head>
<body>
    <!-- Mobile Sidebar Overlay -->
    <div class="sidebar-overlay" id="sidebarOverlay"></div>

    <!-- Sidebar -->
    <aside class="sidebar shadow" id="sidebar">
        <div class="sidebar-header">
            <i class="fa-solid fa-car-side text-info me-3 fs-5"></i>
            <span class="fw-bold fs-5 tracking-wide">Auto Advisor</span>
        </div>

        <div class="flex-grow-1 overflow-auto py-3">
            <div class="nav-section-title">Main</div>
            <a href="#" class="nav-link active">
                <div class="d-flex align-items-center">
                    <i class="fa-solid fa-gauge-high w-6 me-2"></i>
                    <span>Dashboard</span>
                </div>
            </a>

            <div class="nav-section-title">By Vehicle Type</div>
            
            <a href="#" class="nav-link">
                <div class="d-flex align-items-center">
                    <i class="fa-solid fa-car w-6 me-2 text-secondary"></i> Private Car
                </div>
                <span class="badge-custom">350</span>
            </a>
            <a href="#" class="nav-link">
                <div class="d-flex align-items-center">
                    <i class="fa-solid fa-taxi w-6 me-2 text-secondary"></i> Commercial
                </div>
                <span class="badge-custom">120</span>
            </a>
            <a href="#" class="nav-link">
                <div class="d-flex align-items-center">
                    <i class="fa-solid fa-bus w-6 me-2 text-secondary"></i> Bus
                </div>
                <span class="badge-custom">45</span>
            </a>
            <a href="#" class="nav-link">
                <div class="d-flex align-items-center">
                    <i class="fa-solid fa-truck w-6 me-2 text-secondary"></i> Truck
                </div>
                <span class="badge-custom">80</span>
            </a>
            <a href="#" class="nav-link">
                <div class="d-flex align-items-center">
                    <i class="fa-solid fa-motorcycle w-6 me-2 text-secondary"></i> Two-wheeler
                </div>
                <span class="badge-custom">410</span>
            </a>
            <a href="#" class="nav-link">
                <div class="d-flex align-items-center">
                    <i class="fa-solid fa-van-shuttle w-6 me-2 text-secondary"></i> Other Commercial
                </div>
                <span class="badge-custom">195</span>
            </a>

            <div class="nav-section-title">By Customer</div>
            <div class="px-4 mb-3">
                <div class="position-relative">
                    <input type="text" placeholder="Search Client..." class="form-control form-control-sm bg-dark text-white border-secondary ps-4">
                    <i class="fa-solid fa-search position-absolute top-50 start-0 translate-middle-y ms-2 text-secondary small"></i>
                </div>
            </div>
        </div>

        <div class="p-3 border-top border-secondary">
            <div class="d-flex align-items-center gap-3">
                <div class="rounded-circle bg-primary d-flex align-items-center justify-content-center text-white fw-bold" style="width: 32px; height: 32px;">A</div>
                <div class="small">
                    <p class="fw-semibold mb-0">Admin User</p>
                    <p class="text-secondary mb-0" style="font-size: 0.75rem; cursor: pointer;">Logout</p>
                </div>
            </div>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        
        <!-- Header -->
        <header class="top-header shadow-sm">
            <div class="d-flex align-items-center gap-3">
                <button class="btn btn-light d-lg-none border-0" id="sidebarToggle">
                    <i class="fa-solid fa-bars fs-5"></i>
                </button>
                <h1 class="h5 fw-bold text-dark mb-0">Dashboard Overview</h1>
            </div>
            
            <div class="d-flex gap-2">
                <button class="btn btn-success btn-sm d-flex align-items-center gap-2 fw-medium">
                    <i class="fa-solid fa-file-excel"></i> Import Excel
                </button>
                <button class="btn btn-primary btn-sm d-flex align-items-center gap-2 fw-medium">
                    <i class="fa-solid fa-plus"></i> Add Vehicle
                </button>
            </div>
        </header>

        <!-- Dashboard Content -->
        <div class="content-scrollable bg-light">
            
            <!-- Summary Cards -->
            <div class="row g-4 mb-4">
                <div class="col-md-3">
                    <div class="card border-0 shadow-sm summary-card h-100">
                        <div class="card-body d-flex align-items-center justify-content-between">
                            <div>
                                <p class="text-secondary text-uppercase fw-bold small mb-1">Total Vehicles</p>
                                <h3 class="fw-bold text-dark mb-0">1,200</h3>
                            </div>
                            <div class="rounded-circle bg-primary bg-opacity-10 d-flex align-items-center justify-content-center text-primary" style="width: 48px; height: 48px;">
                                <i class="fa-solid fa-car fs-5"></i>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-md-3">
                    <div class="card border-warning shadow-sm summary-card h-100 bg-warning bg-opacity-10">
                        <div class="card-body d-flex align-items-center justify-content-between">
                            <div>
                                <p class="text-warning text-uppercase fw-bold small mb-1" style="filter: brightness(0.8);">Expiring (5 Days)</p>
                                <h3 class="fw-bold text-dark mb-0" style="color: #854d0e;">12</h3>
                            </div>
                            <div class="rounded-circle bg-warning bg-opacity-25 d-flex align-items-center justify-content-center text-warning" style="width: 48px; height: 48px; filter: brightness(0.9);">
                                <i class="fa-solid fa-clock fs-5"></i>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-md-3">
                    <div class="card border-danger shadow-sm summary-card h-100 bg-danger bg-opacity-10">
                        <div class="card-body d-flex align-items-center justify-content-between">
                            <div>
                                <p class="text-danger text-uppercase fw-bold small mb-1">Already Expired</p>
                                <h3 class="fw-bold text-danger mb-0">5</h3>
                            </div>
                            <div class="rounded-circle bg-danger bg-opacity-25 d-flex align-items-center justify-content-center text-danger" style="width: 48px; height: 48px;">
                                <i class="fa-solid fa-triangle-exclamation fs-5"></i>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-md-3">
                    <div class="card border-0 shadow-sm summary-card h-100">
                        <div class="card-body d-flex align-items-center justify-content-between">
                            <div>
                                <p class="text-secondary text-uppercase fw-bold small mb-1">Total Clients</p>
                                <h3 class="fw-bold text-dark mb-0">400</h3>
                            </div>
                            <div class="rounded-circle bg-success bg-opacity-10 d-flex align-items-center justify-content-center text-success" style="width: 48px; height: 48px;">
                                <i class="fa-solid fa-users fs-5"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Action Required Section -->
            <div class="d-flex flex-column gap-4">
                
                <!-- Expired Documents Table -->
                <div class="card border-danger shadow-sm overflow-hidden">
                    <div class="card-header bg-danger bg-opacity-10 border-danger d-flex justify-content-between align-items-center py-3">
                        <h2 class="h6 text-danger fw-bold mb-0 d-flex align-items-center gap-2">
                            <i class="fa-solid fa-circle-exclamation"></i> Already Expired Documents
                        </h2>
                        <span class="badge bg-danger bg-opacity-25 text-danger rounded-pill">5 Vehicles</span>
                    </div>
                    <div class="table-container">
                        <table class="excel-table">
                            <thead>
                                <tr>
                                    <th class="sticky-col-left bg-light" style="width: 40px;"><input type="checkbox" class="form-check-input"></th>
                                    <th class="sticky-col-left-2 bg-light" style="width: 100px;">Actions</th>
                                    <th>Vehicle No</th>
                                    <th>Client Name</th>
                                    <th>Mobile</th>
                                    <th>Type</th>
                                    <th>RC Expiry</th>
                                    <th>TP Insurance</th>
                                    <th>Comp. Insurance</th>
                                    <th>PUC (Petrol)</th>
                                    <th>PUC (Diesel)</th>
                                    <th>Fitness (New)</th>
                                    <th>Fitness (5yr+)</th>
                                    <th>Permit (State)</th>
                                    <th>Permit (India)</th>
                                    <th>Tax</th>
                                </tr>
                            </thead>
                            <tbody id="expiredTableBody">
                                <!-- Populated by JS -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Upcoming Expiry Table -->
                <div class="card border-warning shadow-sm overflow-hidden">
                    <div class="card-header bg-warning bg-opacity-10 border-warning d-flex justify-content-between align-items-center py-3">
                        <h2 class="h6 text-warning fw-bold mb-0 d-flex align-items-center gap-2" style="color: #854d0e;">
                            <i class="fa-solid fa-clock"></i> Expiring Within 5 Days
                        </h2>
                        <span class="badge bg-warning bg-opacity-25 text-warning rounded-pill" style="color: #854d0e !important;">12 Vehicles</span>
                    </div>
                    <div class="table-container">
                        <table class="excel-table">
                            <thead>
                                <tr>
                                    <th class="sticky-col-left bg-light" style="width: 40px;"><input type="checkbox" class="form-check-input"></th>
                                    <th class="sticky-col-left-2 bg-light" style="width: 100px;">Actions</th>
                                    <th>Vehicle No</th>
                                    <th>Client Name</th>
                                    <th>Mobile</th>
                                    <th>Type</th>
                                    <th>RC Expiry</th>
                                    <th>TP Insurance</th>
                                    <th>Comp. Insurance</th>
                                    <th>PUC (Petrol)</th>
                                    <th>PUC (Diesel)</th>
                                    <th>Fitness (New)</th>
                                    <th>Fitness (5yr+)</th>
                                    <th>Permit (State)</th>
                                    <th>Permit (India)</th>
                                    <th>Tax</th>
                                </tr>
                            </thead>
                            <tbody id="upcomingTableBody">
                                <!-- Populated by JS -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- All Vehicles Table -->
                <div class="card border-0 shadow-sm d-flex flex-column" style="height: 600px;">
                    <div class="card-header bg-light border-bottom d-flex align-items-center justify-content-between py-3">
                        <div class="d-flex align-items-center gap-3">
                            <h2 class="h6 fw-bold text-secondary mb-0">All Vehicles</h2>
                            <div class="position-relative">
                                <i class="fa-solid fa-search position-absolute top-50 start-0 translate-middle-y ms-3 text-secondary small"></i>
                                <input type="text" id="searchInput" placeholder="Search vehicle, client..." class="form-control form-control-sm ps-5" style="width: 250px;">
                            </div>
                            <select id="statusFilter" class="form-select form-select-sm" style="width: auto;">
                                <option value="all">Filter by Status</option>
                                <option value="all">All</option>
                                <option value="expired">Expired</option>
                                <option value="upcoming">Upcoming</option>
                            </select>
                        </div>
                        <div>
                            <button class="btn btn-outline-danger btn-sm d-flex align-items-center gap-1 fw-medium">
                                <i class="fa-solid fa-trash-can"></i> Bulk Delete
                            </button>
                        </div>
                    </div>

                    <div class="flex-grow-1 overflow-auto table-container">
                        <table class="excel-table">
                            <thead class="sticky-top shadow-sm">
                                <tr>
                                    <th class="sticky-col-left bg-light" style="width: 40px;"><input type="checkbox" class="form-check-input"></th>
                                    <th class="sticky-col-left-2 bg-light" style="width: 100px;">Actions</th>
                                    <th>Vehicle No</th>
                                    <th>Client Name</th>
                                    <th>Mobile</th>
                                    <th>Type</th>
                                    <th>RC Expiry</th>
                                    <th>TP Insurance</th>
                                    <th>Comp. Insurance</th>
                                    <th>PUC (Petrol)</th>
                                    <th>PUC (Diesel)</th>
                                    <th>Fitness (New)</th>
                                    <th>Fitness (5yr+)</th>
                                    <th>Permit (State)</th>
                                    <th>Permit (India)</th>
                                    <th>Tax</th>
                                    <th>Driving Lic.</th>
                                    <th>Route Permit</th>
                                    <th>Conductor Lic.</th>
                                    <th>Plate Status</th>
                                </tr>
                            </thead>
                            <tbody id="allVehiclesTableBody">
                                <!-- Populated by JS -->
                            </tbody>
                        </table>
                    </div>
                    <div class="card-footer bg-light border-top py-2 d-flex justify-content-between align-items-center small text-secondary">
                        <span>Showing 1 to 50 of 1200 entries</span>
                        <div class="btn-group">
                            <button class="btn btn-outline-secondary btn-sm bg-white">Previous</button>
                            <button class="btn btn-primary btn-sm">1</button>
                            <button class="btn btn-outline-secondary btn-sm bg-white">2</button>
                            <button class="btn btn-outline-secondary btn-sm bg-white">3</button>
                            <button class="btn btn-outline-secondary btn-sm bg-white">Next</button>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </main>

    <!-- Reminder Modal (Bootstrap Modal) -->
    <div class="modal fade" id="reminderModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content shadow">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title d-flex align-items-center gap-2">
                        <i class="fa-solid fa-paper-plane"></i> Send Manual Reminder
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body p-4">
                    <div class="alert alert-primary d-flex flex-column gap-1 mb-4">
                        <div class="d-flex justify-content-between">
                            <span class="fw-semibold">Client Name:</span>
                            <span id="modalClientName" class="fw-medium">...</span>
                        </div>
                        <div class="d-flex justify-content-between">
                            <span class="fw-semibold">Vehicle No:</span>
                            <span id="modalVehicleNo" class="fw-medium">...</span>
                        </div>
                    </div>

                    <div class="mb-4">
                        <label class="form-label fw-bold text-secondary small">Select Expiring Document(s):</label>
                        <div class="border rounded p-3 bg-light" style="max-height: 150px; overflow-y: auto;">
                            <div class="form-check mb-2">
                                <input class="form-check-input" type="checkbox" checked id="doc1">
                                <label class="form-check-label small" for="doc1">
                                    Third Party Insurance <span class="text-danger fw-bold ms-1">(Expires: 20-12-2025)</span>
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="doc2">
                                <label class="form-check-label small" for="doc2">
                                    PUC Diesel <span class="text-danger fw-bold ms-1">(Expires: 21-12-2025)</span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <div class="mb-3">
                        <label class="form-label fw-bold text-secondary small">Message Preview (Editable):</label>
                        <div class="position-relative">
                            <textarea class="form-control text-sm" rows="4">Dear Client, your vehicle GJ01AB1234 Third Party Insurance expires on 20-12-2025. Please contact us for renewal. - Shree Krupa PUC Centre</textarea>
                            <div class="position-absolute bottom-0 end-0 p-2 text-secondary small" style="font-size: 0.75rem;">145 chars</div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer bg-light">
                    <button type="button" class="btn btn-light text-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-success d-flex align-items-center gap-2">
                        <i class="fa-brands fa-whatsapp"></i> Send SMS & WhatsApp
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Vehicle Modal (Bootstrap Modal) -->
    <div class="modal fade" id="editVehicleModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content shadow">
                <div class="modal-header bg-dark text-white">
                    <h5 class="modal-title d-flex align-items-center gap-2">
                        <i class="fa-solid fa-pen-to-square"></i> Edit Vehicle Details
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body p-4">
                    <form id="editVehicleForm" class="row g-3">
                        <!-- Basic Info -->
                        <div class="col-12 border-bottom pb-2 mb-2">
                            <h6 class="text-secondary text-uppercase small fw-bold mb-0">Basic Information</h6>
                        </div>
                        
                        <div class="col-md-4">
                            <label class="form-label small fw-bold text-secondary">Vehicle Number</label>
                            <input type="text" id="editVehicleNo" class="form-control form-control-sm">
                        </div>
                        <div class="col-md-4">
                            <label class="form-label small fw-bold text-secondary">Client Name</label>
                            <input type="text" id="editClientName" class="form-control form-control-sm">
                        </div>
                        <div class="col-md-4">
                            <label class="form-label small fw-bold text-secondary">Mobile Number</label>
                            <input type="text" id="editMobile" class="form-control form-control-sm">
                        </div>
                        <div class="col-md-4">
                            <label class="form-label small fw-bold text-secondary">Vehicle Type</label>
                            <select id="editVehicleType" class="form-select form-select-sm">
                                <option>Private Car</option>
                                <option>Commercial Car</option>
                                <option>Bus</option>
                                <option>Truck</option>
                                <option>Two-wheeler</option>
                                <option>Other Commercial</option>
                            </select>
                        </div>

                        <!-- Document Expiry Dates -->
                        <div class="col-12 border-bottom pb-2 mb-2 mt-4">
                            <h6 class="text-secondary text-uppercase small fw-bold mb-0">Document Expiry Dates</h6>
                        </div>

                        <div class="col-md-4">
                            <label class="form-label small fw-bold text-secondary">RC Expiry</label>
                            <input type="date" id="editRC" class="form-control form-control-sm">
                        </div>
                        <div class="col-md-4">
                            <label class="form-label small fw-bold text-secondary">TP Insurance</label>
                            <input type="date" id="editTP" class="form-control form-control-sm">
                        </div>
                        <div class="col-md-4">
                            <label class="form-label small fw-bold text-secondary">Comp. Insurance</label>
                            <input type="date" id="editComp" class="form-control form-control-sm">
                        </div>
                        <div class="col-md-4">
                            <label class="form-label small fw-bold text-secondary">PUC (Petrol)</label>
                            <input type="date" id="editPUCPetrol" class="form-control form-control-sm">
                        </div>
                        <div class="col-md-4">
                            <label class="form-label small fw-bold text-secondary">PUC (Diesel)</label>
                            <input type="date" id="editPUCDiesel" class="form-control form-control-sm">
                        </div>
                        <div class="col-md-4">
                            <label class="form-label small fw-bold text-secondary">Fitness (New)</label>
                            <input type="date" id="editFitNew" class="form-control form-control-sm">
                        </div>
                        <div class="col-md-4">
                            <label class="form-label small fw-bold text-secondary">Fitness (5yr+)</label>
                            <input type="date" id="editFitOld" class="form-control form-control-sm">
                        </div>
                        <div class="col-md-4">
                            <label class="form-label small fw-bold text-secondary">Permit (State)</label>
                            <input type="date" id="editPermitState" class="form-control form-control-sm">
                        </div>
                        <div class="col-md-4">
                            <label class="form-label small fw-bold text-secondary">Permit (India)</label>
                            <input type="date" id="editPermitIndia" class="form-control form-control-sm">
                        </div>
                        <div class="col-md-4">
                            <label class="form-label small fw-bold text-secondary">Tax</label>
                            <input type="date" id="editTax" class="form-control form-control-sm">
                        </div>
                        <div class="col-md-4">
                            <label class="form-label small fw-bold text-secondary">Driving Lic.</label>
                            <input type="date" id="editDrivingLic" class="form-control form-control-sm">
                        </div>
                        <div class="col-md-4">
                            <label class="form-label small fw-bold text-secondary">Route Permit</label>
                            <input type="date" id="editRoutePermit" class="form-control form-control-sm">
                        </div>
                        <div class="col-md-4">
                            <label class="form-label small fw-bold text-secondary">Conductor Lic.</label>
                            <input type="date" id="editConductorLic" class="form-control form-control-sm">
                        </div>
                        <div class="col-md-4">
                            <label class="form-label small fw-bold text-secondary">Plate Status</label>
                            <select id="editPlateStatus" class="form-select form-select-sm">
                                <option>OK</option>
                                <option>Damaged</option>
                                <option>Missing</option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer bg-light">
                    <button type="button" class="btn btn-light text-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" onclick="saveVehicleChanges()" class="btn btn-primary d-flex align-items-center gap-2">
                        <i class="fa-solid fa-save"></i> Save Changes
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        // --- Mock Data ---
        let vehicles = [
            {
                id: 1,
                vehicleNo: 'GJ01AB1234',
                clientName: 'John Doe',
                mobile: '9876543210',
                type: 'Private Car',
                rcExpiry: '2025-12-12', // Expired
                tpInsurance: '2026-01-15',
                compInsurance: '2026-01-15',
                pucPetrol: '',
                pucDiesel: '2026-02-20',
                fitnessNew: '',
                fitnessOld: '',
                permitState: '',
                permitIndia: '',
                tax: '2026-01-01',
                drivingLic: '',
                routePermit: '',
                conductorLic: '',
                plateStatus: 'OK'
            },
            {
                id: 2,
                vehicleNo: 'MH02XY9999',
                clientName: 'Fatah Digital',
                mobile: '9988776655',
                type: 'Truck',
                rcExpiry: '2025-12-18', // Today
                tpInsurance: '2025-12-20', // Upcoming
                compInsurance: '2026-06-20',
                pucPetrol: '',
                pucDiesel: '2026-01-30',
                fitnessNew: '',
                fitnessOld: '2026-03-15',
                permitState: '2026-04-01',
                permitIndia: '2026-04-01',
                tax: '2026-01-01',
                drivingLic: '',
                routePermit: '',
                conductorLic: '',
                plateStatus: 'OK'
            },
            {
                id: 3,
                vehicleNo: 'GJ04MK5555',
                clientName: 'M.A. Engineering',
                mobile: '9123456789',
                type: 'Two-wheeler',
                rcExpiry: '2026-05-15',
                tpInsurance: '2026-05-15',
                compInsurance: '',
                pucPetrol: '2026-05-20',
                pucDiesel: '',
                fitnessNew: '',
                fitnessOld: '',
                permitState: '',
                permitIndia: '2026-08-01',
                tax: '2028-10-10',
                drivingLic: '',
                routePermit: '',
                conductorLic: '',
                plateStatus: 'OK'
            }
        ];

        // --- State ---
        let currentEditId = null;
        let reminderModal;
        let editVehicleModal;

        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            // Initialize Modals
            reminderModal = new bootstrap.Modal(document.getElementById('reminderModal'));
            editVehicleModal = new bootstrap.Modal(document.getElementById('editVehicleModal'));
            
            // Sidebar Toggle Logic
            const sidebar = document.getElementById('sidebar');
            const sidebarOverlay = document.getElementById('sidebarOverlay');
            const sidebarToggle = document.getElementById('sidebarToggle');

            if(sidebarToggle) {
                sidebarToggle.addEventListener('click', () => {
                    sidebar.classList.toggle('show');
                    sidebarOverlay.classList.toggle('show');
                });
            }

            if(sidebarOverlay) {
                sidebarOverlay.addEventListener('click', () => {
                    sidebar.classList.remove('show');
                    sidebarOverlay.classList.remove('show');
                });
            }

            // Event Listeners
            document.getElementById('searchInput').addEventListener('input', renderAllVehiclesTable);
            document.getElementById('statusFilter').addEventListener('change', renderAllVehiclesTable);
            
            // Add Vehicle Button
            const addBtn = document.querySelector('button.btn-primary.d-flex.gap-2'); // "Add Vehicle" button
            if(addBtn) {
                addBtn.onclick = openAddModal;
            }

            // Initial Render
            renderAll();
        });

        // --- Rendering Logic ---
        function renderAll() {
            renderDashboard();
            renderExpiredTable();
            renderUpcomingTable();
            renderAllVehiclesTable();
        }

        function renderDashboard() {
            const total = vehicles.length;
            const expired = vehicles.filter(v => getVehicleStatus(v) === 'expired').length;
            const upcoming = vehicles.filter(v => getVehicleStatus(v) === 'upcoming').length;
            
            // Update cards (Assuming order: Total, Upcoming, Expired, Clients)
            const cards = document.querySelectorAll('.summary-card h3');
            if(cards.length >= 4) {
                cards[0].innerText = total.toLocaleString();
                cards[1].innerText = upcoming.toLocaleString();
                cards[2].innerText = expired.toLocaleString();
                // Mock client count
                const uniqueClients = new Set(vehicles.map(v => v.clientName)).size;
                cards[3].innerText = uniqueClients.toLocaleString();
            }
            
            // Update headers
            const expiredHeaderBadge = document.querySelector('.card.border-danger .badge');
            if(expiredHeaderBadge) expiredHeaderBadge.innerText = `${expired} Vehicles`;

            const upcomingHeaderBadge = document.querySelector('.card.border-warning .badge');
            if(upcomingHeaderBadge) upcomingHeaderBadge.innerText = `${upcoming} Vehicles`;
        }

        function renderExpiredTable() {
            const tbody = document.getElementById('expiredTableBody');
            const expiredVehicles = vehicles.filter(v => getVehicleStatus(v) === 'expired');
            tbody.innerHTML = expiredVehicles.map(v => generateRowHTML(v, 'row-expired')).join('');
            attachRowEvents();
        }

        function renderUpcomingTable() {
            const tbody = document.getElementById('upcomingTableBody');
            const upcomingVehicles = vehicles.filter(v => getVehicleStatus(v) === 'upcoming');
            tbody.innerHTML = upcomingVehicles.map(v => generateRowHTML(v, 'row-expiring-soon')).join('');
            attachRowEvents();
        }

        function renderAllVehiclesTable() {
            const tbody = document.getElementById('allVehiclesTableBody');
            const searchText = document.getElementById('searchInput').value.toLowerCase();
            const statusFilter = document.getElementById('statusFilter').value;

            let filtered = vehicles.filter(v => {
                const matchesSearch = v.vehicleNo.toLowerCase().includes(searchText) || 
                                      v.clientName.toLowerCase().includes(searchText);
                
                let matchesStatus = true;
                const status = getVehicleStatus(v);
                if (statusFilter === 'expired') matchesStatus = status === 'expired';
                if (statusFilter === 'upcoming') matchesStatus = status === 'upcoming';
                
                return matchesSearch && matchesStatus;
            });

            tbody.innerHTML = filtered.map(v => generateRowHTML(v, 'bg-white')).join('');
            
            // Update footer count
            const footerSpan = document.querySelector('.card-footer span');
            if(footerSpan) footerSpan.innerText = `Showing ${filtered.length} of ${vehicles.length} entries`;
            
            attachRowEvents();
        }

        function generateRowHTML(v, rowClass) {
            // Helper to format date for display
            const d = (dateStr) => {
                if (!dateStr) return '<span class="cell-na">N/A</span>';
                const date = new Date(dateStr);
                const day = String(date.getDate()).padStart(2, '0');
                const month = String(date.getMonth() + 1).padStart(2, '0');
                const year = date.getFullYear();
                return `${day}-${month}-${year}`;
            };

            // Check specific expiry for highlighting cells
            const check = (dateStr) => {
                if(!dateStr) return '';
                const status = getDateStatus(dateStr);
                if(status === 'expired') return 'text-danger fw-bold';
                if(status === 'upcoming') return 'text-warning fw-bold'; // darker yellow text
                return '';
            };

            return `
                <tr class="${rowClass}" data-id="${v.id}">
                    <td class="sticky-col-left text-center ${rowClass}"><input type="checkbox" class="form-check-input"></td>
                    <td class="sticky-col-left-2 ${rowClass} text-center">
                        <button onclick="openReminderModal('${v.vehicleNo}', '${v.clientName}')" class="btn btn-link p-0 text-primary me-2"><i class="fa-brands fa-whatsapp fs-6"></i></button>
                        <button onclick="openEditModal(${v.id})" class="btn btn-link p-0 text-secondary" title="Edit"><i class="fa-solid fa-pen"></i></button>
                        <button onclick="deleteVehicle(${v.id})" class="btn btn-link p-0 text-danger ms-2" title="Delete"><i class="fa-solid fa-trash"></i></button>
                    </td>
                    <td class="fw-bold" data-field="vehicleNo">${v.vehicleNo}</td>
                    <td data-field="clientName">${v.clientName}</td>
                    <td data-field="mobile">${v.mobile}</td>
                    <td data-field="type">${v.type}</td>
                    <td class="${check(v.rcExpiry)}" data-field="rcExpiry">${d(v.rcExpiry)}</td>
                    <td class="${check(v.tpInsurance)}" data-field="tpInsurance">${d(v.tpInsurance)}</td>
                    <td class="${check(v.compInsurance)}" data-field="compInsurance">${d(v.compInsurance)}</td>
                    <td class="${check(v.pucPetrol)}" data-field="pucPetrol">${d(v.pucPetrol)}</td>
                    <td class="${check(v.pucDiesel)}" data-field="pucDiesel">${d(v.pucDiesel)}</td>
                    <td class="${check(v.fitnessNew)}" data-field="fitnessNew">${d(v.fitnessNew)}</td>
                    <td class="${check(v.fitnessOld)}" data-field="fitnessOld">${d(v.fitnessOld)}</td>
                    <td class="${check(v.permitState)}" data-field="permitState">${d(v.permitState)}</td>
                    <td class="${check(v.permitIndia)}" data-field="permitIndia">${d(v.permitIndia)}</td>
                    <td class="${check(v.tax)}" data-field="tax">${d(v.tax)}</td>
                    ${rowClass === 'bg-white' ? `
                        <td data-field="drivingLic">${d(v.drivingLic)}</td>
                        <td data-field="routePermit">${d(v.routePermit)}</td>
                        <td data-field="conductorLic">${d(v.conductorLic)}</td>
                        <td data-field="plateStatus">${v.plateStatus}</td>
                    ` : ''}
                </tr>
            `;
        }

        function attachRowEvents() {
            const cells = document.querySelectorAll('td[data-field]');
            cells.forEach(cell => {
                cell.ondblclick = function() { makeEditable(this); };
            });
        }

        // --- Helper Functions ---
        function getDateStatus(dateStr) {
            if(!dateStr) return 'ok';
            const today = new Date();
            today.setHours(0,0,0,0);
            const date = new Date(dateStr);
            const diffTime = date - today;
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            
            if (diffDays < 0) return 'expired';
            if (diffDays <= 5) return 'upcoming';
            return 'ok';
        }

        function getVehicleStatus(v) {
            const dates = [v.rcExpiry, v.tpInsurance, v.compInsurance, v.pucPetrol, v.pucDiesel, v.fitnessNew, v.fitnessOld, v.permitState, v.permitIndia, v.tax];
            let status = 'ok';
            for(let d of dates) {
                const s = getDateStatus(d);
                if(s === 'expired') return 'expired'; // Priority 1
                if(s === 'upcoming') status = 'upcoming'; // Priority 2
            }
            return status;
        }

        // --- Actions ---
        function openReminderModal(vehicleNo, clientName) {
            document.getElementById('modalVehicleNo').innerText = vehicleNo;
            document.getElementById('modalClientName').innerText = clientName;
            reminderModal.show();
        }

        function openAddModal() {
            currentEditId = null;
            document.getElementById('editVehicleForm').reset();
            document.querySelector('#editVehicleModal .modal-title').innerHTML = '<i class="fa-solid fa-plus"></i> Add New Vehicle';
            editVehicleModal.show();
        }

        function openEditModal(id) {
            currentEditId = id;
            const v = vehicles.find(x => x.id === id);
            if(!v) return;

            document.querySelector('#editVehicleModal .modal-title').innerHTML = '<i class="fa-solid fa-pen-to-square"></i> Edit Vehicle Details';
            
            document.getElementById('editVehicleNo').value = v.vehicleNo;
            document.getElementById('editClientName').value = v.clientName;
            document.getElementById('editMobile').value = v.mobile;
            document.getElementById('editVehicleType').value = v.type;
            
            document.getElementById('editRC').value = v.rcExpiry;
            document.getElementById('editTP').value = v.tpInsurance;
            document.getElementById('editComp').value = v.compInsurance;
            document.getElementById('editPUCPetrol').value = v.pucPetrol;
            document.getElementById('editPUCDiesel').value = v.pucDiesel;
            document.getElementById('editFitNew').value = v.fitnessNew;
            document.getElementById('editFitOld').value = v.fitnessOld;
            document.getElementById('editPermitState').value = v.permitState;
            document.getElementById('editPermitIndia').value = v.permitIndia;
            document.getElementById('editTax').value = v.tax;
            document.getElementById('editDrivingLic').value = v.drivingLic;
            document.getElementById('editRoutePermit').value = v.routePermit;
            document.getElementById('editConductorLic').value = v.conductorLic;
            document.getElementById('editPlateStatus').value = v.plateStatus;

            editVehicleModal.show();
        }

        function saveVehicleChanges() {
            const formData = {
                vehicleNo: document.getElementById('editVehicleNo').value,
                clientName: document.getElementById('editClientName').value,
                mobile: document.getElementById('editMobile').value,
                type: document.getElementById('editVehicleType').value,
                rcExpiry: document.getElementById('editRC').value,
                tpInsurance: document.getElementById('editTP').value,
                compInsurance: document.getElementById('editComp').value,
                pucPetrol: document.getElementById('editPUCPetrol').value,
                pucDiesel: document.getElementById('editPUCDiesel').value,
                fitnessNew: document.getElementById('editFitNew').value,
                fitnessOld: document.getElementById('editFitOld').value,
                permitState: document.getElementById('editPermitState').value,
                permitIndia: document.getElementById('editPermitIndia').value,
                tax: document.getElementById('editTax').value,
                drivingLic: document.getElementById('editDrivingLic').value,
                routePermit: document.getElementById('editRoutePermit').value,
                conductorLic: document.getElementById('editConductorLic').value,
                plateStatus: document.getElementById('editPlateStatus').value
            };

            if(currentEditId) {
                // Update
                const index = vehicles.findIndex(v => v.id === currentEditId);
                if(index !== -1) {
                    vehicles[index] = { ...vehicles[index], ...formData };
                }
            } else {
                // Create
                const newId = vehicles.length > 0 ? Math.max(...vehicles.map(v => v.id)) + 1 : 1;
                vehicles.push({ id: newId, ...formData });
            }

            editVehicleModal.hide();
            renderAll();
            // alert('Saved successfully!');
        }

        function deleteVehicle(id) {
            if(confirm('Are you sure you want to delete this vehicle?')) {
                vehicles = vehicles.filter(v => v.id !== id);
                renderAll();
            }
        }

        function makeEditable(td) {
            if (td.querySelector('input')) return;
            if (td.innerText === 'N/A') return; // Simple check

            const field = td.getAttribute('data-field');
            const rowId = parseInt(td.closest('tr').getAttribute('data-id'));
            const vehicle = vehicles.find(v => v.id === rowId);
            
            if(!vehicle) return;

            const currentValue = vehicle[field]; // Get raw value from data, not formatted text
            const input = document.createElement('input');
            
            // Determine type
            const isDate = field.includes('Expiry') || field.includes('Insurance') || field.includes('PUC') || field.includes('Fitness') || field.includes('Permit') || field.includes('Tax') || field.includes('Lic');
            
            if (isDate) {
                input.type = 'date';
                input.value = currentValue;
            } else {
                input.type = 'text';
                input.value = currentValue;
            }
            
            input.className = 'w-100 h-100 border-0 bg-transparent p-0 m-0';
            input.style.outline = 'none';
            
            const save = () => {
                // Update data model
                vehicle[field] = input.value;
                // Re-render to format correctly and update status colors
                renderAll();
            };

            input.onblur = save;
            input.onkeydown = function(e) {
                if(e.key === 'Enter') {
                    this.blur();
                }
            };

            td.innerText = '';
            td.appendChild(input);
            input.focus();
        }
    </script>
</body>
</html>
